# عقارات أسيوط API

## نظرة عامة
هذا هو الباك إند لبرنامج عقارات أسيوط، وهو تطبيق ويب يربط المالكين بالمستأجرين مباشرة داخل محافظة أسيوط بدون وسطاء.

## الميزات الرئيسية
- تسجيل الدخول والتسجيل بالبريد الإلكتروني ورقم الهاتف
- عرض الشقق والمكاتب للإيجار أو البيع
- البحث حسب الموقع، النوع، السعر، وعدد الغرف
- عرض صور وفيديوهات للعقار
- التواصل مباشر بين المالك والمستأجر
- نظام خاص للطلاب مع تجميع الطلبات حسب الكلية

## التقنيات المستخدمة
- .NET 9.0
- Entity Framework Core
- SQL Server
- JWT Authentication
- AutoMapper
- Swagger/OpenAPI

## إعداد المشروع

### المتطلبات
- .NET 9.0 SDK
- SQL Server
- Visual Studio 2022 أو VS Code

### التثبيت
1. استنسخ المشروع
2. افتح Terminal في مجلد المشروع
3. قم بتشغيل الأوامر التالية:

```bash
dotnet restore
dotnet ef database update
dotnet run
```

### إعداد قاعدة البيانات
يتم استخدام SQL Server مع قاعدة بيانات `AsuitAqaarDB`. تأكد من تحديث connection string في `appsettings.json`.

## API Endpoints

### المصادقة (Authentication)

#### POST /api/auth/register
تسجيل مستخدم جديد
```json
{
  "name": "اسم المستخدم",
  "email": "user@example.com",
  "phoneNumber": "01123456789",
  "password": "كلمة المرور",
  "adminPhoneNumber": "رقم الهاتف للمالك (اختياري)"
}
```

#### POST /api/auth/login
تسجيل الدخول
```json
{
  "email": "user@example.com",
  "password": "كلمة المرور"
}
```

### العقارات (Properties)

#### POST /api/property
إنشاء عقار جديد (يتطلب مصادقة)
```json
{
  "title": "عنوان العقار",
  "description": "وصف العقار",
  "price": 1000.00,
  "type": 0,
  "category": 0,
  "area": "المنطقة",
  "subArea": "المنطقة الفرعية",
  "numberOfRooms": 3,
  "areaSize": 120.5,
  "floorNumber": 2,
  "hasElevator": true,
  "hasParking": false,
  "hasBalcony": true,
  "address": "العنوان التفصيلي",
  "requiredStudentsCount": 4,
  "allowedColleges": "كلية الطب,كلية الهندسة",
  "imageUrls": ["url1", "url2"],
  "videoUrls": ["video1", "video2"]
}
```

#### GET /api/property/{id}
الحصول على عقار محدد

#### GET /api/property/search
البحث في العقارات
```
/api/property/search?type=0&area=المنطقة&minPrice=500&maxPrice=2000
```

#### GET /api/property/areas
الحصول على قائمة المناطق

#### GET /api/property/areas/{area}/subareas
الحصول على المناطق الفرعية لمنطقة معينة

#### GET /api/property/types
الحصول على أنواع العقارات

#### GET /api/property/categories
الحصول على فئات العقارات

### طلبات الطلاب (Student Requests)

#### POST /api/studentrequest
إنشاء طلب طالب جديد (يتطلب مصادقة)
```json
{
  "studentName": "اسم الطالب",
  "studentPhone": "01123456789",
  "college": "كلية الطب",
  "area": "المنطقة",
  "subArea": "المنطقة الفرعية",
  "requiredStudentsCount": 3,
  "additionalRequirements": "متطلبات إضافية"
}
```

#### GET /api/studentrequest/{id}
الحصول على طلب طالب محدد

#### GET /api/studentrequest/search
البحث في طلبات الطلاب

#### PUT /api/studentrequest/{id}/status
تحديث حالة طلب الطالب (يتطلب مصادقة)

#### GET /api/studentrequest/colleges
الحصول على قائمة الكليات

#### GET /api/studentrequest/areas
الحصول على قائمة المناطق لطلبات الطلاب

#### GET /api/studentrequest/areas/{area}/subareas
الحصول على المناطق الفرعية لطلبات الطلاب

#### GET /api/studentrequest/statuses
الحصول على حالات الطلبات

## أنواع العقارات
- 0: Sale (بيع)
- 1: FamilyRent (إيجار سكن عائلي)
- 2: StudentRent (إيجار سكن طلاب)

## فئات العقارات
- 0: Apartment (شقة)
- 1: Office (مكتب)
- 2: Villa (فيلا)
- 3: Studio (استوديو)

## حالات طلبات الطلاب
- 0: Pending (قيد الانتظار)
- 1: Processing (قيد التنفيذ)
- 2: Completed (مكتمل)
- 3: Cancelled (ملغي)

## المناطق المدعومة
### مناطق أسيوط
- الايمان
- الزهراء
- الخميس
- الهلالى
- فريال
- صلاح سالم
- الوديه
- المعلمين
- الاربعين
- المحكمه
- الناصرية
- الحمراء
- شارع سيد
- موقف الازهر
- نزله عبدالله
- منقباد

### مراكز أسيوط
- ديروط
- اسيوط الجديده
- البدارى
- ساحل سليم
- الغنائم
- ابو تيج
- صدفا
- الفتح
- منفلوط
- ابنوب
- القوصيه

## نظام الرسوم
- عند تأجير العقار: تخصم المنصة 15% من قيمة الإيجار الشهري
- عند البيع أو الشراء: تخصم 0.25% فقط من قيمة البيع
- عند تأجير مكاتب إدارية: تخصم 15% من قيمة الإيجار
- للطلاب: يتم دفع 100 جنيه فقط عند استلام الشقة كرسوم دعم

## سياسة الخصوصية
- يتم جمع بيانات أساسية فقط مثل الاسم، رقم الهاتف، العنوان، صور العقار
- تُستخدم بياناتك فقط لتحسين تجربة الاستخدام وتسهيل التواصل داخل المنصة
- لا يتم مشاركة بياناتك مع أي طرف ثالث بدون إذنك أو وفق القانون
- نستخدم تقنيات حديثة لحماية البيانات، والوصول إليها مقتصر على الإدارة فقط
- يمكنك تعديل أو حذف حسابك وبياناتك بالكامل في أي وقت

## ملاحظات مهمة
- يمنع التحايل أو إتمام الاتفاق مع المالك خارج التطبيق دون علم الإدارة، وإلا سيتم إيقاف الحساب
- رقم الهاتف للمالك يظهر للإدمن فقط وليس للمستخدمين العاديين
- يتم تجميع طلبات الطلاب حسب الكلية (الطلبة في الكليات الطبية مع بعض، والطلبة في هندسة وحاسبات مع بعض، وباقي الكليات مع بعض) 